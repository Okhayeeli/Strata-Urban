<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notifications Management - StrataUrban Admin</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f7fa;
      color: #333;
    }

    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      height: 100vh;
      width: 260px;
      background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px 0;
      transition: all 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }

    .sidebar.collapsed {
      width: 80px;
    }

    .logo-section {
      padding: 0 20px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      font-size: 2rem;
      min-width: 40px;
    }

    .logo-text h2 {
      font-size: 1.4rem;
      font-weight: 700;
    }

    .logo-text p {
      font-size: 0.8rem;
      opacity: 0.9;
    }

    .sidebar.collapsed .logo-text {
      display: none;
    }

    .nav-menu {
      list-style: none;
    }

    .nav-item {
      margin: 5px 10px;
    }

    .nav-link {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      color: white;
      text-decoration: none;
      border-radius: 10px;
      transition: all 0.3s ease;
      gap: 12px;
    }

    .nav-link:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .nav-link.active {
      background: rgba(255, 255, 255, 0.25);
      font-weight: 600;
    }

    .nav-icon {
      font-size: 1.3rem;
      min-width: 25px;
      text-align: center;
    }

    .sidebar.collapsed .nav-text {
      display: none;
    }

    .main-content {
      margin-left: 260px;
      transition: all 0.3s ease;
      min-height: 100vh;
    }

    .main-content.expanded {
      margin-left: 80px;
    }

    .top-header {
      background: white;
      padding: 20px 30px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 999;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .menu-toggle {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #667eea;
      padding: 8px;
    }

    .header-title h1 {
      font-size: 1.8rem;
      color: #333;
    }

    .header-title p {
      font-size: 0.9rem;
      color: #666;
      margin-top: 2px;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .user-profile {
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      padding: 8px 15px;
      border-radius: 25px;
      transition: background 0.3s ease;
    }

    .user-profile:hover {
      background: #f5f7fa;
    }

    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
    }

    .dropdown {
      position: relative;
    }

    .dropdown-menu {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
      margin-top: 10px;
      padding: 10px 0;
      min-width: 200px;
      display: none;
    }

    .dropdown.active .dropdown-menu {
      display: block;
    }

    .dropdown-item {
      padding: 12px 20px;
      color: #333;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: background 0.3s ease;
    }

    .dropdown-item:hover {
      background: #f5f7fa;
    }

    .dropdown-item.logout {
      color: #ef4444;
      border-top: 1px solid #f0f0f0;
    }

    .page-content {
      padding: 30px;
    }

    .stats-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-box {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: transform 0.3s ease;
    }

    .stat-box:hover {
      transform: translateY(-3px);
    }

    .stat-info h4 {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 8px;
    }

    .stat-info p {
      font-size: 1.8rem;
      font-weight: 700;
      color: #333;
    }

    .stat-icon {
      font-size: 2.5rem;
      opacity: 0.7;
    }

    .filters-section {
      background: white;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
      margin-bottom: 20px;
    }

    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 15px;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-group label {
      font-size: 0.9rem;
      font-weight: 500;
      color: #666;
    }

    .filter-group input,
    .filter-group select {
      padding: 10px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.95rem;
      transition: border-color 0.3s;
    }

    .filter-group input:focus,
    .filter-group select:focus {
      outline: none;
      border-color: #667eea;
    }

    .filter-actions {
      display: flex;
      gap: 10px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: #f5f7fa;
      color: #666;
    }

    .btn-secondary:hover {
      background: #e0e0e0;
    }

    .users-table {
      background: white;
      border-radius: 15px;
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
      overflow: hidden;
    }

    .table-header {
      padding: 20px;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-header h3 {
      font-size: 1.2rem;
      color: #333;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: #f5f7fa;
    }

    th {
      padding: 15px;
      text-align: left;
      font-weight: 600;
      color: #666;
      font-size: 0.9rem;
    }

    th.notification-col {
      text-align: center;
      width: 100px;
    }

    td {
      padding: 15px;
      border-top: 1px solid #f0f0f0;
    }

    td.notification-cell {
      text-align: center;
    }

    tbody tr {
      transition: background 0.3s ease;
    }

    tbody tr:hover {
      background: #f9fafb;
    }

    .user-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .user-name {
      font-weight: 600;
      color: #333;
      font-size: 0.95rem;
    }

    .user-email {
      font-size: 0.8rem;
      color: #999;
    }

    .user-id {
      font-size: 0.75rem;
      color: #ccc;
    }

    .user-role {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .role-client {
      background: #dbeafe;
      color: #1e40af;
    }

    .role-provider {
      background: #d1fae5;
      color: #065f46;
    }

    .role-driver {
      background: #fef3c7;
      color: #92400e;
    }

    .role-admin {
      background: #fce7f3;
      color: #831843;
    }

    /* Custom Checkbox Styling */
    .notification-checkbox {
      position: relative;
      width: 24px;
      height: 24px;
      cursor: pointer;
      appearance: none;
      -webkit-appearance: none;
      border: 2px solid #d1d5db;
      border-radius: 6px;
      background: white;
      transition: all 0.3s ease;
    }

    .notification-checkbox:hover {
      border-color: #667eea;
    }

    .notification-checkbox:checked {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
    }

    .notification-checkbox:checked::after {
      content: '‚úì';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 14px;
      font-weight: bold;
    }

    .notification-checkbox:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination {
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    .pagination button {
      padding: 8px 15px;
      border: 1px solid #e0e0e0;
      background: white;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .pagination button:hover:not(:disabled) {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination .current-page {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      top: 90px;
      right: 30px;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      display: none;
      align-items: center;
      gap: 12px;
      z-index: 10000;
      animation: slideInRight 0.3s ease;
      min-width: 300px;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .toast.show {
      display: flex;
    }

    .toast.success {
      background: #10b981;
      color: white;
    }

    .toast.error {
      background: #ef4444;
      color: white;
    }

    .toast.info {
      background: #3b82f6;
      color: white;
    }

    .toast-icon {
      font-size: 1.5rem;
    }

    .toast-content {
      flex: 1;
    }

    .toast-message {
      font-weight: 600;
      font-size: 0.95rem;
    }

    /* Loading Spinner */
    .spinner-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.3);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .spinner-overlay.active {
      display: flex;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.mobile-open {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
      }

      .stats-row {
        grid-template-columns: repeat(2, 1fr);
      }

      .filters-grid {
        grid-template-columns: 1fr;
      }

      table {
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>
<aside class="sidebar" id="sidebar">
  <div class="logo-section">
    <div class="logo-icon">üöõ</div>
    <div class="logo-text">
      <h2>StrataUrban</h2>
      <p>Admin Portal</p>
    </div>
  </div>

  <ul class="nav-menu">
    <li class="nav-item">
      <a href="/admin/dashboard" class="nav-link">
        <span class="nav-icon">üìä</span>
        <span class="nav-text">Dashboard</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/bookings" class="nav-link">
        <span class="nav-icon">üìÖ</span>
        <span class="nav-text">Bookings</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/providers" class="nav-link">
        <span class="nav-icon">üè¢</span>
        <span class="nav-text">Providers</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/clients" class="nav-link">
        <span class="nav-icon">üë•</span>
        <span class="nav-text">Clients</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/drivers" class="nav-link">
        <span class="nav-icon">üöó</span>
        <span class="nav-text">Drivers</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/vehicles" class="nav-link">
        <span class="nav-icon">üöô</span>
        <span class="nav-text">Vehicles</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/areas" class="nav-link">
        <span class="nav-icon">üó∫Ô∏è</span>
        <span class="nav-text">Service Areas</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/revenue" class="nav-link">
        <span class="nav-icon">üí∞</span>
        <span class="nav-text">Revenue</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/analytics" class="nav-link">
        <span class="nav-icon">üìà</span>
        <span class="nav-text">Analytics</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/notifications" class="nav-link active">
        <span class="nav-icon">üîî</span>
        <span class="nav-text">Notifications</span>
      </a>
    </li>
    <li class="nav-item">
      <a href="/admin/settings" class="nav-link">
        <span class="nav-icon">‚öôÔ∏è</span>
        <span class="nav-text">Settings</span>
      </a>
    </li>
  </ul>
</aside>

<main class="main-content" id="mainContent">
  <header class="top-header">
    <div class="header-left">
      <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
      <div class="header-title">
        <h1>Notifications Management</h1>
        <p>Manage user notification preferences</p>
      </div>
    </div>

    <div class="header-right">
      <div class="dropdown">
        <div class="user-profile" onclick="toggleDropdown()">
          <div class="user-avatar">
            <span th:text="${#strings.substring(adminUser.firstName ?: 'A', 0, 1)}">A</span>
          </div>
        </div>

        <div class="dropdown-menu">
          <a href="/admin/profile" class="dropdown-item">
            <span>üë§</span> Profile
          </a>
          <a href="/admin/settings" class="dropdown-item">
            <span>‚öôÔ∏è</span> Settings
          </a>
          <a href="/admin/logout" class="dropdown-item logout">
            <span>üö™</span> Logout
          </a>
        </div>
      </div>
    </div>
  </header>

  <div class="page-content">
    <!-- Stats Row -->
    <div class="stats-row">
      <div class="stat-box">
        <div class="stat-info">
          <h4>Total Users</h4>
          <p th:text="${totalUsers} ?: '0'">1,234</p>
        </div>
        <div class="stat-icon">üë•</div>
      </div>
      <div class="stat-box">
        <div class="stat-info">
          <h4>Email Enabled</h4>
          <p th:text="${emailEnabledCount} ?: '0'">856</p>
        </div>
        <div class="stat-icon">üìß</div>
      </div>
      <div class="stat-box">
        <div class="stat-info">
          <h4>SMS Enabled</h4>
          <p th:text="${smsEnabledCount} ?: '0'">432</p>
        </div>
        <div class="stat-icon">üí¨</div>
      </div>
      <div class="stat-box">
        <div class="stat-info">
          <h4>Push Enabled</h4>
          <p th:text="${pushEnabledCount} ?: '0'">678</p>
        </div>
        <div class="stat-icon">üîî</div>
      </div>
      <div class="stat-box">
        <div class="stat-info">
          <h4>In-App Enabled</h4>
          <p th:text="${inAppEnabledCount} ?: '0'">1,102</p>
        </div>
        <div class="stat-icon">üì±</div>
      </div>
    </div>

    <!-- Filters Section -->
    <div class="filters-section">
      <form th:action="@{/admin/notifications}" method="get">
        <div class="filters-grid">
          <div class="filter-group">
            <label>Search Users</label>
            <input type="text" name="search" th:value="${param.search}" placeholder="Name, email or ID...">
          </div>
          <div class="filter-group">
            <label>User Role</label>
            <select name="role">
              <option value="">All Roles</option>
              <option value="CLIENT" th:selected="${param.role == 'CLIENT'}">Client</option>
              <option value="PROVIDER" th:selected="${param.role == 'PROVIDER'}">Provider</option>
              <option value="DRIVER" th:selected="${param.role == 'DRIVER'}">Driver</option>
              <option value="ADMIN" th:selected="${param.role == 'ADMIN'}">Admin</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Email Status</label>
            <select name="emailEnabled">
              <option value="">All</option>
              <option value="true" th:selected="${param.emailEnabled == 'true'}">Enabled</option>
              <option value="false" th:selected="${param.emailEnabled == 'false'}">Disabled</option>
            </select>
          </div>
          <div class="filter-group">
            <label>SMS Status</label>
            <select name="smsEnabled">
              <option value="">All</option>
              <option value="true" th:selected="${param.smsEnabled == 'true'}">Enabled</option>
              <option value="false" th:selected="${param.smsEnabled == 'false'}">Disabled</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Sort By</label>
            <select name="sortBy">
              <option value="firstName" th:selected="${param.sortBy == 'firstName' || param.sortBy == null}">Name</option>
              <option value="email" th:selected="${param.sortBy == 'email'}">Email</option>
              <option value="roles" th:selected="${param.sortBy == 'roles'}">Role</option>
              <option value="id" th:selected="${param.sortBy == 'id'}">User ID</option>
            </select>
          </div>
          <div class="filter-group">
            <label>Order</label>
            <select name="sortDir">
              <option value="ASC" th:selected="${param.sortDir == 'ASC' || param.sortDir == null}">Ascending</option>
              <option value="DESC" th:selected="${param.sortDir == 'DESC'}">Descending</option>
            </select>
          </div>
        </div>
        <div class="filter-actions">
          <button type="submit" class="btn btn-primary">Apply Filters</button>
          <a href="/admin/notifications" class="btn btn-secondary">Clear Filters</a>
        </div>
      </form>
    </div>

    <!-- Users Table -->
    <div class="users-table">
      <div class="table-header">
        <h3>User Notification Preferences (<span th:text="${users.totalElements}">0</span> users)</h3>
      </div>

      <table>
        <thead>
        <tr>
          <th>#</th>
          <th>User</th>
          <th>Role</th>
          <th>Location</th>
          <th class="notification-col">üìß Email</th>
          <th class="notification-col">üí¨ SMS</th>
          <th class="notification-col">üîî Push</th>
          <th class="notification-col">üì± In-App</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="user, iterStat : ${users.content}">
          <td th:text="${iterStat.count + (users.number * users.size)}">1</td>
          <td>
            <div class="user-info">
              <span class="user-name" th:text="${user.firstName} + ' ' + ${user.lastName}">John Doe</span>
              <span class="user-email" th:text="${user.email}">john.doe@example.com</span>
              <span class="user-id" th:text="'ID: ' + ${user.id}">ID: 123</span>
            </div>
          </td>
          <td>
                        <span class="user-role"
                              th:classappend="'role-' + ${#strings.toLowerCase(user.roles)}"
                              th:text="${user.roles}">CLIENT</span>
          </td>
          <td th:text="${user.city != null && user.state != null ? user.city + ', ' + user.state : (user.city != null ? user.city : 'N/A')}">Lagos, Lagos</td>

          <!-- Email Checkbox -->
          <td class="notification-cell">
            <input type="checkbox"
                   class="notification-checkbox"
                   th:checked="${userPreferences[user.id]['EMAIL']}"
                   th:data-user-id="${user.id}"
                   data-channel="EMAIL"
                   onchange="toggleNotification(this)">
          </td>

          <!-- SMS Checkbox -->
          <td class="notification-cell">
            <input type="checkbox"
                   class="notification-checkbox"
                   th:checked="${userPreferences[user.id]['SMS']}"
                   th:data-user-id="${user.id}"
                   data-channel="SMS"
                   onchange="toggleNotification(this)">
          </td>

          <!-- Push Checkbox -->
          <td class="notification-cell">
            <input type="checkbox"
                   class="notification-checkbox"
                   th:checked="${userPreferences[user.id]['PUSH']}"
                   th:data-user-id="${user.id}"
                   data-channel="PUSH"
                   onchange="toggleNotification(this)">
          </td>

          <!-- In-App Checkbox -->
          <td class="notification-cell">
            <input type="checkbox"
                   class="notification-checkbox"
                   th:checked="${userPreferences[user.id]['IN_APP']}"
                   th:data-user-id="${user.id}"
                   data-channel="IN_APP"
                   onchange="toggleNotification(this)">
          </td>
        </tr>
        </tbody>
      </table>

      <!-- Pagination -->
      <div class="pagination" th:if="${users.totalPages > 1}">
        <button th:disabled="${users.first}"
                th:onclick="'navigateToPage(' + ${users.number - 1} + ')'">
          Previous
        </button>

        <button th:each="i : ${#numbers.sequence(0, users.totalPages - 1)}"
                th:text="${i + 1}"
                th:classappend="${i == users.number} ? 'current-page' : ''"
                th:onclick="'navigateToPage(' + ${i} + ')'">
          1
        </button>

        <button th:disabled="${users.last}"
                th:onclick="'navigateToPage(' + ${users.number + 1} + ')'">
          Next
        </button>
      </div>
    </div>
  </div>
</main>

<!-- Toast Notification -->
<div class="toast" id="toast">
  <span class="toast-icon" id="toastIcon">‚úì</span>
  <div class="toast-content">
    <div class="toast-message" id="toastMessage">Success!</div>
  </div>
</div>

<!-- Loading Spinner -->
<div class="spinner-overlay" id="spinnerOverlay">
  <div class="spinner"></div>
</div>

<script>
  function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const mainContent = document.getElementById('mainContent');

    if (window.innerWidth > 768) {
      sidebar.classList.toggle('collapsed');
      mainContent.classList.toggle('expanded');
    } else {
      sidebar.classList.toggle('mobile-open');
    }
  }

  function toggleDropdown() {
    const dropdown = document.querySelector('.dropdown');
    dropdown.classList.toggle('active');
  }

  document.addEventListener('click', function(event) {
    const dropdown = document.querySelector('.dropdown');
    if (!dropdown.contains(event.target)) {
      dropdown.classList.remove('active');
    }
  });

  /**
   * Toggle notification preference for a user
   * Endpoint: PUT /api/v2/notifications/preferences/channel
   */
  async function toggleNotification(checkbox) {
    const userId = checkbox.getAttribute('data-user-id');
    const channel = checkbox.getAttribute('data-channel');
    const enabled = checkbox.checked;

    // Show loading
    showSpinner();

    try {
      const response = await fetch(`/admin/notifications/preferences/channel?userId=${userId}&channel=${channel}&enabled=${enabled}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        }
      });

      hideSpinner();

      if (response.ok) {
        showToast(`${channel} notifications ${enabled ? 'enabled' : 'disabled'} successfully`, 'success');

        // Optionally reload stats
        setTimeout(() => {
          // window.location.reload();
        }, 1000);
      } else {
        checkbox.checked = !enabled; // Revert checkbox
        const errorData = await response.json();
        showToast(errorData.message || 'Failed to update notification preference', 'error');
      }
    } catch (error) {
      hideSpinner();
      checkbox.checked = !enabled; // Revert checkbox
      showToast('An error occurred: ' + error.message, 'error');
      console.error('Error toggling notification:', error);
    }
  }

  /**
   * Navigate to a specific page
   */
  function navigateToPage(pageNumber) {
    const url = new URL(window.location.href);
    url.searchParams.set('page', pageNumber);
    window.location.href = url.toString();
  }

  /**
   * Show toast notification
   */
  function showToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    const toastMessage = document.getElementById('toastMessage');
    const toastIcon = document.getElementById('toastIcon');

    // Set icon based on type
    if (type === 'success') {
      toastIcon.textContent = '‚úì';
    } else if (type === 'error') {
      toastIcon.textContent = '‚úó';
    } else if (type === 'info') {
      toastIcon.textContent = '‚Ñπ';
    }

    toastMessage.textContent = message;
    toast.className = 'toast ' + type + ' show';

    setTimeout(() => {
      toast.classList.remove('show');
    }, 3000);
  }

  /**
   * Show loading spinner
   */
  function showSpinner() {
    document.getElementById('spinnerOverlay').classList.add('active');
  }

  /**
   * Hide loading spinner
   */
  function hideSpinner() {
    document.getElementById('spinnerOverlay').classList.remove('active');
  }
</script>
</body>
</html>